---
title: "MA677 A1"
author: "Ruxin Liu"
output: pdf_document
---

## Assignment Objective:
Reproduce example 3.11 on page 102 of Introduction of Probability. 

Based on the question, we know that the ordinary aspirin can cure headaches for 
60% of the time, which can be written in P(cure headache) = 0.6. The drug company
claims that their new additive aspirin can be more effective, which means that 
P(cure headache) > 0.6. Therefore, in our hypothesis test the null hypothesis is
that: $H_0:P=0.6$ and the alternative hypothesis is that: $H_1:P>0.6$. 

In this situation, we may encounter 2 types of errors: type 1 error and type 2 
error. Type 1 error happens when we reject the null hypothesis when the null
hypothesis is true and $\alpha$ is the probability of type 1 error. Type 2 error
happens when we do not reject the null hypothesis when the alternative hypothesis
is true and $\beta$ is the probability of type 2 error. And we can calculate the 
power of the test by using the formula: $1-\beta$. Here the goal is to find the 
critical value m that makes both probabilities ($\alpha$ and $\beta$) small. 

Now, we are going to reproduce the program PowerCurve that being mentioned in the 
book to find the critical value m. The sample size n is set to be 100 and p has 
a range from 0.4 to 1. Firstly, we can create a function to plot the power curve.

```{r}
library(tidyverse)
power_curve <- function(m, n){
  p <- seq(from = 0.4, to = 1, by = 0.01)
  a <- dbinom(m, size = n, prob = p)
  power <- cumsum(a)
  return(power)
}
```

```{r}
x_axis <- seq(from = 0.4, to = 1, by = 0.01)
ggplot() +
  geom_line(aes(x_axis, power_curve(60, 100))) +
  # Adding the box from 0.6 to 0.8, with bottom and top at heights 0.05 and 0.95
  geom_rect(aes(xmin = 0.6, xmax = 0.8, ymin = 0.05, ymax = 0.95, col = "red"), 
            fill = NA) +
  xlab("Probability (p)") +
  ylab("Power (1 - beta)") +
  ggtitle("The power curve") +
  theme(legend.position = "none") +
  theme(plot.title = element_text(hjust = 0.5))
```

